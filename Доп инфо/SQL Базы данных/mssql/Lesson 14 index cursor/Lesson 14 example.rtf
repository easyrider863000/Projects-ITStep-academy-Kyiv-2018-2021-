{\rtf1\ansi\ansicpg1251\deff0\nouicompat{\fonttbl{\f0\fnil\fcharset204 Times New Roman;}{\f1\fnil\fcharset0 Times New Roman;}{\f2\fnil\fcharset0 Calibri;}{\f3\fnil Consolas;}{\f4\fnil\fcharset204 Calibri;}{\f5\fnil\fcharset204 Consolas;}{\f6\fnil\fcharset0 Consolas;}{\f7\fnil\fcharset204 Cambria;}{\f8\fnil\fcharset0 Cambria;}{\f9\fnil\fcharset0 Courier New;}{\f10\fnil Calibri;}{\f11\fnil\fcharset2 Symbol;}}
{\colortbl ;\red0\green0\blue255;\red255\green255\blue255;\red0\green0\blue0;\red128\green128\blue128;\red255\green0\blue0;\red0\green128\blue0;\red255\green0\blue255;\red0\green255\blue0;\red54\green95\blue145;\red79\green129\blue189;}
{\*\generator Riched20 10.0.18362}\viewkind4\uc1 
\pard\sl240\slmult1\qj\f0\fs24\lang1049\'d7\'f2\'ee \'f2\'e0\'ea\'ee\'e5 \'e4\'ee\'ec\'e5\'ed; \'ce\'f2\'ed\'ee\'f8\'e5\'ed\'e8\'e5; \'ca\'ee\'f0\'f2\'e5\'e6; \'cd\'ee\'f0\'ec\'e0\'eb\'fc\'ed\'e0\'ff \'f4\'ee\'f0\'ec\'e0?\par
\'d7\'f2\'ee \'f2\'e0\'ea\'ee\'e5 \'ef\'e5\'f0\'e2\'e8\'f7\'ed\'fb\'e9 \'ea\'eb\'fe\'f7 \'e8 \'f7\'f2\'ee \'f2\'e0\'ea\'ee\'e5 \'e2\'ed\'e5\'f8\'ed\'e8\'e9 \'ea\'eb\'fe\'f7?\par
\'d6\'e5\'eb\'ee\'f1\'f2\'ed\'ee\'f1\'f2\'fc \'e4\'e0\'ed\'ed\'fb\'f5 \'e8 \'f1\'f1\'fb\'eb\'ee\'f7\'ed\'e0\'ff \'f6\'e5\'eb\'ee\'f1\'f2\'ed\'ee\'f1\'f2\'fc.\par
\'d7\'f2\'ee \'f2\'e0\'ea\'ee\'e5 \'ed\'ee\'f0\'ec\'e0\'eb\'e8\'e7\'e0\'f6\'e8\'ff \'c1\'c4? \'d7\'f2\'ee \'f2\'e0\'ea\'ee\'e5 \'e4\'e5\'ed\'ee\'f0\'ec\'e0\'eb\'e8\'e7\'e0\'f6\'e8\'ff \'c1\'c4? \'c4\'eb\'ff \'f7\'e5\'e3\'ee \'ee\'ed\'e0 \'ed\'f3\'e6\'ed\'e0?\par
\'ca\'e0\'ea\'e8\'e5 \'f2\'e8\'ef\'fb \'f1\'ee\'e5\'e4\'e8\'ed\'e5\'ed\'e8\'e9 (join) \'f2\'e0\'e1\'eb\'e8\'f6 \'f1\'f3\'f9\'e5\'f1\'f2\'e2\'f3\'fe\'f2? \'c2 \'f7\'e5\'ec \'e8\'f5 \'f0\'e0\'e7\'ed\'e8\'f6\'e0?\par
\'c2 \'f7\'e5\'ec \'f0\'e0\'e7\'ed\'e8\'f6\'e0 \'ec\'e5\'e6\'e4\'f3 WHERE \'e8 HAVING?\par
\'d7\'f2\'ee \'f2\'e0\'ea\'ee\'e5 \'ef\'ee\'e4\'e7\'e0\'ef\'f0\'ee\'f1 (sub-query)?\f1\lang1033  \f0\lang1049\'d2\'e0\'e1\'eb\'e8\'f7\'ed\'fb\'e5 \'e2\'fb\'f0\'e0\'e6\'e5\'ed\'e8\'ff\par
\f1\lang1033 GROUP BY, \lang9 ORDER BY\par
CASE, CAST, CONVERT\par
INSERT, UPDATE, DELETE and TRUNCATE\~\par
\f0\lang1049\'d7\'f2\'ee \'f2\'e0\'ea\'ee\'e5 \'f1\'e5\'e0\'ed\'f1, \'ef\'e0\'ea\'e5\'f2 \'e8 \'e1\'eb\'ee\'ea \'ea\'ee\'e4\'e0\par
\'cf\'ee\'ed\'ff\'f2\'e8\'e5 \'f2\'f0\'e0\'ed\'e7\'e0\'ea\'f6\'e8\'e8. \f1\lang1033 ACID\f0\lang1058 . \lang1049\'c1\'eb\'ee\'ea\'e8\'f0\'ee\'e2\'ea\'e8, \'f3\'f0\'ee\'e2\'ed\'e8 \'e8\'e7\'ee\'eb\'ff\'f6\'e8\'e8 \'f2\'f0\'e0\'ed\'e7\'e0\'ea\'f6\'e8\'e9 \'e8 \'ef\'f0\'ee\'e1\'eb\'e5\'ec\'fb \'e1\'eb\'ee\'ea\'e8\'f0\'ee\'e2\'e0\'ed\'e8\'ff \'e4\'e0\'ed\'ed\'fb\'f5\par
\'d4\'f3\'ed\'ea\'f6\'e8\'e8 . \'ce\'f2\'eb\'e8\'f7\'e8\'e5 \'ee\'f2 \'f5\'f0\'e0\'ed\'e8\'ec\'fb\'f5 \'ef\'f0\'ee\'f6\'e5\'e4\'f3\'f0. \'cf\'f0\'e5\'e8\'ec\'f3\'f9\'e5\'f1\'f2\'e2\'e0 \'f5\'f0\'e0\'ed\'e8\'ec\'fb\'f5 \'ef\'f0\'ee\'f6\'e5\'e4\'f3\'f0\par
\'d2\'f0\'e8\'e3\'e3\'e5\'f0\'fb \f1\lang1033 DML.\f0\lang1049  \'c2\'e8\'e4\'fb \'f2\'f0\'e8\'e3\'e3\'e5\'f0\'ee\'e2. \'cf\'ee\'f1\'eb\'e5\'e4\'ee\'e2\'e0\'f2\'e5\'eb\'fc\'ed\'ee\'f1\'f2\'fc \'f1\'f0\'e0\'e1\'e0\'f2\'fb\'e2\'e0\'ed\'e8\'ff \'f2\'f0\'e8\'e3\'e3\'e5\'f0\'ee\'e2. \f1\lang1033  \f0\lang1049\'d2\'e0\'e1\'eb\'e8\'f6\'fb \f1\lang1033 inserted \f0\lang1049\'e8 \f1\lang1033 deleted\par
\f0\lang1049\'cf\'ee\'ed\'ff\'f2\'e8\'e5 \'e8\'ed\'e4\'e5\'ea\'f1\'e0. \'ca\'eb\'e0\'f1\'f2\'e5\'f0\'ed\'fb\'e5 \'e8 \'ed\'e5\'ea\'eb\'e0\'f1\'f2\'e5\'f0\'ed\'fb\'e5 \'e8\'ed\'e4\'e5\'ea\'f1\'fb.\f1\lang1033\par

\pard\sl240\slmult1\ul\f2\fs22\par

\pard\cf1\highlight2\ulnone\f3\fs19\lang9\par
set\cf3  \cf1 statistics\cf3  \cf1 io\cf3  \cf1 on\cf3\par
\cf1 set\cf3  \cf1 statistics\cf3  \cf1 time\cf3  \cf1 on\cf3\par
\cf1\par
set\cf3  \cf1 statistics\cf3  \cf1 time\cf3  \cf1 off\cf3\par
\cf1 set\cf3  \cf1 statistics\cf3  \cf1 io\cf3  \cf1 off\cf3\par

\pard\sa200\sl276\slmult1\cf0\highlight0\f4\fs22\lang1058\'c7\lang1049\'e0\'ef\'f0\'ee\'f1\'fb \'ea \'c1\'c4 AdventureWorks2017\par
\b\f2\lang1033 1. \f4\lang1049\'d1\'f0\'e0\'e2\'ed\'e5\'ed\'e8\'e5 \'f0\'e5\'e7\'f3\'eb\'fc\'f2\'e0\'f2\'ee\'e2 \'e2\'fb\'ef\'ee\'eb\'ed\'e5\'ed\'e8\'ff \par
\cf1\highlight2\b0\f3\fs19 select\cf3  \cf4 *\cf3  \cf1 from\cf3  Person\cf4 .\cf1 Address\f5  --\'e1\'e5\'e7 \'f3\'f1\'eb\'ee\'e2\'e8\'ff \'ee\'f2\'e1\'ee\'f0\'e0\cf3\f3\par
\cf1 where\cf3  AddressID\cf4 >\cf3 0\par
\cf0\b\f6\lang1033 2.\f5\lang1058  \'d7\'f2\'ee \'e4\'e0\'e5\'f2 \f3\lang1033 include\f5\lang1058 !\par

\pard\i\lang1049\'c7\'e0\'ef\'f0\'ee\'f1\cf1\b0\f3\par

\pard\sa200\sl276\slmult1\i0\lang1033 select\cf3  \cf4 *\cf3  \cf1 from\cf3  Sales\cf4 .\cf3 SalesOrderHeader\par

\pard\b\i\f5\lang1049\'c4\'ee\'e1\'e0\'e2\'eb\'e5\'ed\'e8\'e5 \'e8\'ed\'e4\'e5\'ea\'f1\'e0\par
\cf1\b0\i0 create\cf3  \cf1 index\cf3  index_SalesOrderHeader_CreditCardApprovalCode \cf1 on\cf3  Sales\cf4 .\cf3 SalesOrderHeader\cf4 (\cf3 CreditCardApprovalCode\cf4 )\cf3  \cf1 include\cf4 (\cf3 OrderDate\cf4 )\cf3\par
\cf1 go\par
\cf0\b\i\'c7\'e0\'ef\'f0\'ee\'f1\cf1\b0\f3\par
\i0 SELECT\cf3  AddressLine1\cf4 ,\cf3  AddressLine2\cf4 ,\cf3  City\cf4 ,\cf3  StateProvinceID\cf4 ,\cf3  PostalCode  \par
\cf1 FROM\cf3  Person\cf4 .\cf1 Address\cf3   \par
\cf1 WHERE\cf3  PostalCode \cf4 BETWEEN\cf3  \cf5 N'98000'\cf3  \cf4 and\cf3  \cf5 N'99999'\cf4 ;\cf3   \par
\b\i\f5\'c4\'ee\'e1\'e0\'e2\'eb\'e5\'ed\'e8\'e5 \'e8\'ed\'e4\'e5\'ea\'f1\'e0\par
\cf1\b0\i0\f3 CREATE\cf3  \cf1 INDEX\cf3  IX_Address_PostalCode  \f6\lang1033 --\f5\lang1049\'e8\'ed\'e4\'e5\'ea\'f1 \'e1\'e5\'e7 \cf1\f3 INCLUDE \cf3\par
\cf1 ON\cf3  Person\cf4 .\cf1 Address \cf4 (\cf3 PostalCode\cf4 )\cf3   \par
\b\i\par
\cf1\b0\i0 CREATE\cf3  \cf1 INDEX\cf3  IX_Address_PostalCode  \par
\cf1 ON\cf3  Person\cf4 .\cf1 Address \cf4 (\cf3 PostalCode\cf4 )\cf3   \par
\cf1 INCLUDE \cf4 (\cf3 AddressLine1\cf4 ,\cf3  AddressLine2\cf4 ,\cf3  City\cf4 ,\cf3  StateProvinceID\cf4 );\cf1\f5\par
\par

\pard\sa200\sl276\slmult1\cf0\b 3\f6\lang1033 .\f5\lang1058  \'cf\'f0\'ee\'e2\'e5\'f0\'ea\'e0 \'f1\'f3\'f9\'e5\'f1\'f2\'e2\'ee\'e2\'e0\'ed\'e8\'ff \'e8\'ed\'e4\'e5\'ea\'f1\'e0\f6\lang1033\par

\pard\cf1\b0\f3\lang9 select\cf3  \cf4 *\cf3  \cf1 from\cf3  Sales\cf4 .\cf3 SalesOrderHeader\par
\cf6 -- \f5\lang1049\'e4\'ee\'e1\'e0\'e2\'e8\'ec \'e8\'ed\'e4\'e5\'ea\'f1 \'ef\'ee \'ea\'ee\'eb\'ee\'ed\'ea\'e5 CreditCardApprovalCode \cf3\par
\cf6 -- \'e4\'eb\'ff \'f2\'e5\'f1\'f2\'e0 \'e2\'ee\'e7\'fc\'ec\'e5\'ec \'e7\'ed\'e0\'f7\'e5\'ed\'e8\'e5 105623Vi69217\cf3\par
\par
\cf1\b\i if\cf3  \cf4 exists\cf3  \par
\cf1\tab\tab\cf4 (\cf1 SELECT\cf3  \cf7 OBJECT_NAME\cf4 (\cf7 object_id\cf4 )\cf3  \cf1 AS\cf3  table_name\cf4 ,\cf3  \cf1 name\cf3  \cf1 AS\cf3  index_name\cf4 ,\cf3  \cf1 type\cf4 ,\cf3  \cf1 type_desc\cf3\par
\tab\tab\cf1 FROM\cf3  \cf8 sys\cf4 .\cf8 indexes\cf3\par
\tab\tab\cf1 WHERE\cf3  \cf7 object_id\cf3  \cf4 =\cf3  \cf7 OBJECT_ID\cf4 (\cf5 N'Sales.SalesOrderHeader'\cf4 ,\cf3  \cf5 N'U'\cf4 )\cf3  \cf4 and\cf3  \cf1 name\cf4 =\cf5 'index_SalesOrderHeader_CreditCardApprovalCode'\cf4 )\cf3\b0\i0\par
     \cf1 drop\cf3  \cf1 index\cf3  index_SalesOrderHeader_CreditCardApprovalCode \cf1 on\cf3  Sales\cf4 .\cf3 SalesOrderHeader\cf4 ;\cf3\par
\cf1 GO\cf3\par
\cf1 create\cf3  \cf1 index\cf3  index_SalesOrderHeader_CreditCardApprovalCode \cf1 on\cf3  Sales\cf4 .\cf3 SalesOrderHeader\cf4 (\cf3 CreditCardApprovalCode\cf4 )\cf3  \cf1 include\cf4 (\cf3 OrderDate\cf4 )\cf3\par
\cf1 go\cf3\par
\par
\cf1 select\cf3  OrderDate \cf1 from\cf3  Sales\cf4 .\cf3 SalesOrderHeader\par
\cf1 where\cf3  CreditCardApprovalCode \cf4 =\cf3  \cf5 N'105623Vi69217'\cf0\highlight0\f2\fs22\lang9\par

\pard\sa200\sl276\slmult1\highlight2\b\f5\fs19\lang1049\par
4\f6\lang1033 .\f5\lang1058  \'d1\'ee\'f0\'f2\'e8\'f0\'ee\'e2\'ea\'e0\f6\lang1033\par

\pard\cf1\b0\f3\lang9 set\cf3  \cf1 statistics\cf3  \cf1 io\cf3  \cf1 on\cf3\par
\cf1 set\cf3  \cf1 statistics\cf3  \cf1 time\cf3  \cf1 on\par
SELECT\cf3  RejectedQty\cf4 ,\cf1  \cf4 ((\cf3 RejectedQty\cf4 /\cf3 OrderQty\cf4 )*\cf3 100\cf4 )\cf3  \cf1 AS\cf3  RejectionRate\cf4 ,\cf3   \par
    ProductID\cf4 ,\cf3  DueDate  \par
\cf1 FROM\cf3  Purchasing\cf4 .\cf3 PurchaseOrderDetail  \par
\cf1 ORDER\cf3  \cf1 BY\cf3  RejectedQty \cf1 DESC\cf4 ,\cf3  ProductID \cf1 ASC\cf4 ;\cf3   \par
\cf1 set\cf3  \cf1 statistics\cf3  \cf1 time\cf3  \cf1 off\cf3\par
\cf1 set\cf3  \cf1 statistics\cf3  \cf1 io\cf3  \cf1 off\par
\par
\cf0\f5\lang1049\'d1\'ee\'e7\'e4\'e0\'e4\'e8\'ec \'ed\'e5\'ea\'eb\'e0\'f1\'f2\'e5\'f0\'ed\'fb\'e9 \'e8\'ed\'e4\'e5\'ea\'f1\f3\lang9\par
\cf1\par
CREATE\cf3  \cf1 NONCLUSTERED\cf3  \cf1 INDEX\cf3  IX_PurchaseOrderDetail_RejectedQty  \par
\cf1 ON\cf3  Purchasing\cf4 .\cf3 PurchaseOrderDetail  \par
\cf1     \cf4 (\cf3 RejectedQty \cf1 DESC\cf4 ,\cf3  ProductID \cf1 ASC\cf4 ,\cf3  DueDate\cf4 ,\cf3  OrderQty\cf4 );\cf3   \par
\par

\pard\keep\keepn\sb480\sl276\slmult1\cf9\highlight0\b\f7\fs28\lang1049\'ca\'f3\'f0\'f1\'ee\'f0\'fb\par

\pard\sl240\slmult1\qj\cf0\b0\f4\fs22\'c8\'ed\'f1\'f2\'f0\'f3\'ea\'f6\'e8\'e8 Microsoft SQL Server \'f1\'ee\'e7\'e4\'e0\'fe\'f2 \'ef\'ee\'eb\'ed\'fb\'e9 \'f0\'e5\'e7\'f3\'eb\'fc\'f2\'e8\'f0\'f3\'fe\'f9\'e8\'e9 \'ed\'e0\'e1\'ee\'f0, \'ed\'ee \'e1\'fb\'e2\'e0\'fe\'f2 \'f1\'eb\'f3\'f7\'e0\'e8, \'ea\'ee\'e3\'e4\'e0 \'f0\'e5\'e7\'f3\'eb\'fc\'f2\'e0\'f2\'fb \'f3\'e4\'ee\'e1\'ed\'e5\'e5 \'ee\'e1\'f0\'e0\'e1\'e0\'f2\'fb\'e2\'e0\'f2\'fc \'ef\'ee\'f1\'f2\'f0\'ee\'f7\'ed\'ee. \'ce\'f2\'ea\'f0\'fb\'f2\'e8\'e5 \'ea\'f3\'f0\'f1\'ee\'f0\'e0 \'ed\'e0 \'f0\'e5\'e7\'f3\'eb\'fc\'f2\'e8\'f0\'f3\'fe\'f9\'e5\'ec \'ed\'e0\'e1\'ee\'f0\'e5 \'e4\'e5\'eb\'e0\'e5\'f2 \'e2\'ee\'e7\'ec\'ee\'e6\'ed\'ee\'e9 \'e5\'e3\'ee \'ef\'ee\'f1\'f2\'f0\'ee\'f7\'ed\'f3\'fe \'ee\'e1\'f0\'e0\'e1\'ee\'f2\'ea\'f3. \'cc\'ee\'e6\'ed\'ee \'ed\'e0\'e7\'ed\'e0\'f7\'e8\'f2\'fc \'ea\'f3\'f0\'f1\'ee\'f0\'f3 \'ef\'e5\'f0\'e5\'ec\'e5\'ed\'ed\'f3\'fe \'e8\'eb\'e8 \'ef\'e0\'f0\'e0\'ec\'e5\'f2\'f0 \'f1 \'f2\'e8\'ef\'ee\'ec \'e4\'e0\'ed\'ed\'fb\'f5 cursor.\par
\f2\lang9\par

\pard{\pntext\f11\'B7\tab}{\*\pn\pnlvlblt\pnf11\pnindent360{\pntxtb\'B7}}\fi-360\li720\sl240\slmult1 {\cf1\ul\b{\field{\*\fldinst{HYPERLINK "https://msdn.microsoft.com/ru-ru/library/ms180169.aspx"}}{\fldrslt{DECLARE CURSOR (Transact-SQL)}}}}\b\f2\fs22  \par
{\pntext\f11\'B7\tab}{\cf1\ul{\field{\*\fldinst{HYPERLINK "https://msdn.microsoft.com/ru-ru/library/ms190500.aspx"}}{\fldrslt{OPEN (Transact-SQL)}}}}\f2\fs22  \par
{\pntext\f11\'B7\tab}{\cf1\ul{\field{\*\fldinst{HYPERLINK "https://msdn.microsoft.com/ru-ru/library/ms180152.aspx"}}{\fldrslt{FETCH (Transact-SQL)}}}}\f2\fs22  \par
{\pntext\f11\'B7\tab}{\cf1\ul{\field{\*\fldinst{HYPERLINK "https://msdn.microsoft.com/ru-ru/library/ms175035.aspx"}}{\fldrslt{CLOSE (Transact-SQL)}}}}\f2\fs22  \par
{\pntext\f11\'B7\tab}{\cf1\ul{\field{\*\fldinst{HYPERLINK "https://msdn.microsoft.com/ru-ru/library/ms188782.aspx"}}{\fldrslt{DEALLOCATE (Transact-SQL)}}}}\f2\fs22  \par

\pard\keep\keepn\sb200\sl276\slmult1\cf10\f8\fs20 DECLARE CURSOR \par

\pard\sl240\slmult1\qj\cf0\b0\f4\fs22\lang1049\'ce\'ef\'f0\'e5\'e4\'e5\'eb\'ff\'e5\'f2 \'f2\'e0\'ea\'e8\'e5 \'e0\'f2\'f0\'e8\'e1\'f3\'f2\'fb \'f1\'e5\'f0\'e2\'e5\'f0\'ed\'ee\'e3\'ee \'ea\'f3\'f0\'f1\'ee\'f0\'e0 \'ff\'e7\'fb\'ea\'e0 Transact-SQL, \'ea\'e0\'ea \'f1\'e2\'ee\'e9\'f1\'f2\'e2\'e0 \'ef\'f0\'ee\'f1\'ec\'ee\'f2\'f0\'e0 \'e8 \'e7\'e0\'ef\'f0\'ee\'f1, \'e8\'f1\'ef\'ee\'eb\'fc\'e7\'f3\'e5\'ec\'fb\'e9 \'e4\'eb\'ff \'ef\'ee\'f1\'f2\'f0\'ee\'e5\'ed\'e8\'ff \'f0\'e5\'e7\'f3\'eb\'fc\'f2\'e8\'f0\'f3\'fe\'f9\'e5\'e3\'ee \'ed\'e0\'e1\'ee\'f0\'e0, \'ed\'e0 \'ea\'ee\'f2\'ee\'f0\'ee\'ec \'f0\'e0\'e1\'ee\'f2\'e0\'e5\'f2 \'ea\'f3\'f0\'f1\'ee\'f0. \'c8\'ed\'f1\'f2\'f0\'f3\'ea\'f6\'e8\'ff DECLARE CURSOR \'ef\'ee\'e4\'e4\'e5\'f0\'e6\'e8\'e2\'e0\'e5\'f2 \'ea\'e0\'ea \'f1\'e8\'ed\'f2\'e0\'ea\'f1\'e8\'f1 \'f1\'f2\'e0\'ed\'e4\'e0\'f0\'f2\'e0 ISO, \'f2\'e0\'ea \'e8 \'f1\'e8\'ed\'f2\'e0\'ea\'f1\'e8\'f1, \'e8\'f1\'ef\'ee\'eb\'fc\'e7\'f3\'fe\'f9\'e8\'e9 \'ed\'e0\'e1\'ee\'f0 \'f0\'e0\'f1\'f8\'e8\'f0\'e5\'ed\'e8\'e9 \'ff\'e7\'fb\'ea\'e0 Transact-SQL. \par

\pard\sl240\slmult1\cf1\f9\fs20\lang9\par

\pard\li720\sl240\slmult1\highlight2\f3\fs19 DECLARE\cf3  vend_cursor \cf1 CURSOR\cf3   \par
    \cf1 FOR\cf3  \cf1 SELECT\cf3  \cf4 *\cf3  \cf1 FROM\cf3  Purchasing\cf4 .\cf3 Vendor  \par
\cf1 OPEN\cf3  vend_cursor  \par
\par
\cf1 WHILE\cf3  \cf7 @@FETCH_STATUS\cf3  \cf4 =\cf3  0  \par
  \cf1 begin\cf3\par
\tab  \cf1 FETCH\cf3  \cf1 NEXT\cf3  \cf1 FROM\cf3  vend_cursor\cf4 ;\cf3  \par
  \cf1 end\cf3\par
\cf1 CLOSE\cf3  vend_cursor\cf4 ;\cf3   \par
\cf1 DEALLOCATE\cf3  vend_cursor\cf4 ;\cf3  \cf1\highlight0\f9\fs20\par

\pard\sl240\slmult1\cf7 @@FETCH_STATUS\cf0   - \f4\fs22\lang1049\'c2\'ee\'e7\'e2\'f0\'e0\'f9\'e0\'e5\'f2 \'f1\'ee\'f1\'f2\'ee\'ff\'ed\'e8\'e5 \'ef\'ee\'f1\'eb\'e5\'e4\'ed\'e5\'e9 \'e8\'ed\'f1\'f2\'f0\'f3\'ea\'f6\'e8\'e8 FETCH, \b\i\'e2\'fb\'e7\'e2\'e0\'ed\'ed\'ee\'e9 \'e2 \'eb\'fe\'e1\'ee\'ec \'ea\'f3\'f0\'f1\'ee\'f0\'e5\b0\i0 , \'ee\'f2\'ea\'f0\'fb\'f2\'ee\'ec \'e2 \'e4\'e0\'ed\'ed\'ee\'ec \'f1\'ee\'e5\'e4\'e8\'ed\'e5\'ed\'e8\'e8.\par
\par

\pard\sa200\sl276\slmult1\f2\lang9\par

\pard\sl240\slmult1 0, \f4\lang1049\'e5\'f1\'eb\'e8 \'e2\'fb\'e1\'ee\'f0\'ea\'e0 \'e7\'e0\'e2\'e5\'f0\'f8\'e8\'eb\'e0\'f1\'fc \'f3\'f1\'ef\'e5\'f8\'ed\'ee;\par
\f2\lang9 -1, \f4\lang1049\'e5\'f1\'eb\'e8 \'e2\'fb\'e1\'ee\'f0\'ea\'e0 \'e7\'e0\'e2\'e5\'f0\'f8\'e8\'eb\'e0\'f1\'fc \'ed\'e5\'f3\'e4\'e0\'f7\'ed\'ee \'e2\'f1\'eb\'e5\'e4\'f1\'f2\'e2\'e8\'e5 \'ef\'ee\'ef\'fb\'f2\'ea\'e8 \'e2\'fb\'e1\'ee\'f0\'ea\'e8 \'f1\'f2\'f0\'ee\'ea\'e8, \'ed\'e0\'f5\'ee\'e4\'ff\'f9\'e5\'e9\'f1\'ff \'e7\'e0 \'ef\'f0\'e5\'e4\'e5\'eb\'e0\'ec\'e8 \'ea\'f3\'f0\'f1\'ee\'f0\'e0 ;\par
\f2\lang9 -2, \f4\lang1049\'e5\'f1\'eb\'e8 \'e2\'fb\'e1\'ee\'f0\'ea\'e0 \'e7\'e0\'e2\'e5\'f0\'f8\'e8\'eb\'e0\'f1\'fc \'ed\'e5\'f3\'e4\'e0\'f7\'ed\'ee \'e2\'f1\'eb\'e5\'e4\'f1\'f2\'e2\'e8\'e5 \'ef\'ee\'ef\'fb\'f2\'ea\'e8 \'ee\'e1\'f0\'e0\'f9\'e5\'ed\'e8\'ff \'ea \'f3\'e4\'e0\'eb\'e5\'ed\'ed\'ee\'e9 \'e8\'eb\'e8 \'e8\'e7\'ec\'e5\'ed\'e5\'ed\'ed\'ee\'e9 \'f1\'f2\'f0\'ee\'ea\'e5.\par

\pard\highlight2\b\f5\fs19\par

\pard\sl240\slmult1\'c2 \'f1\'eb\'e5\'e4\'f3\'fe\'f9\'e5\'ec \'ef\'f0\'e8\'ec\'e5\'f0\'e5 \'e2\'eb\'ee\'e6\'e5\'ed\'ed\'fb\'e5 \'ea\'f3\'f0\'f1\'ee\'f0\'fb \'e8\'f1\'ef\'ee\'eb\'fc\'e7\'f3\'fe\'f2\'f1\'ff \'e4\'eb\'ff \'e2\'fb\'e2\'ee\'e4\'e0 \'f1\'eb\'ee\'e6\'ed\'ee\'e3\'ee \'ee\'f2\'f7\'e5\'f2\'e0. \'c4\'eb\'ff \'ea\'e0\'e6\'e4\'ee\'e3\'ee \'ef\'ee\'f1\'f2\'e0\'e2\'f9\'e8\'ea\'e0 \'ee\'e1\'fa\'ff\'e2\'eb\'ff\'e5\'f2\'f1\'ff \'e2\'ed\'f3\'f2\'f0\'e5\'ed\'ed\'e8\'e9 \'ea\'f3\'f0\'f1\'ee\'f0.\par
\cf1\b0\f3\lang9\par

\pard DECLARE\cf3  @vendor_id \cf1 int\cf4 ,\cf3  @vendor_name \cf1 nvarchar\cf4 (\cf3 50\cf4 ),\cf3   \par
    @message \cf1 varchar\cf4 (\cf3 80\cf4 ),\cf3  @product \cf1 nvarchar\cf4 (\cf3 50\cf4 );\cf3   \par
  \par
\cf1 PRINT\cf3  \cf5 '-------- Vendor Products Report --------'\cf4 ;\cf3   \par
  \par
\cf1 DECLARE\cf3  vendor_cursor \cf1 CURSOR\cf3  \cf1 FOR\cf3    \par
\cf1 SELECT\cf3  BusinessEntityID\cf4 ,\cf3  \cf1 Name\cf3   \par
\cf1 FROM\cf3  Purchasing\cf4 .\cf3 Vendor  \par
\cf1 WHERE\cf3  PreferredVendorStatus \cf4 =\cf3  1  \par
\cf1 ORDER\cf3  \cf1 BY\cf3  BusinessEntityID\cf4 ;\cf3   \par
  \par
\cf1 OPEN\cf3  vendor_cursor  \par
  \par
\cf1 FETCH\cf3  \cf1 NEXT\cf3  \cf1 FROM\cf3  vendor_cursor   \par
\cf1 INTO\cf3  @vendor_id\cf4 ,\cf3  @vendor_name  \par
  \par
\cf1 WHILE\cf3  \cf7 @@FETCH_STATUS\cf3  \cf4 =\cf3  0  \par
\cf1 BEGIN\cf3   \par
    \cf1 PRINT\cf3  \cf5 ' '\cf3   \par
    \cf1 SELECT\cf3  @message \cf4 =\cf3  \cf5 '----- Products From Vendor: '\cf3  \cf4 +\cf3    \par
        @vendor_name  \par
  \par
    \cf1 PRINT\cf3  @message  \par
  \par
    \cf6 -- Declare an inner cursor based     \cf3\par
    \cf6 -- on vendor_id from the outer cursor.  \cf3\par
  \par
    \cf1 DECLARE\cf3  product_cursor \cf1 CURSOR\cf3  \cf1 FOR\cf3    \par
    \cf1 SELECT\cf3  v\cf4 .\cf1 Name\cf3   \par
    \cf1 FROM\cf3  Purchasing\cf4 .\cf3 ProductVendor pv\cf4 ,\cf3  Production\cf4 .\cf3 Product v  \par
    \cf1 WHERE\cf3  pv\cf4 .\cf3 ProductID \cf4 =\cf3  v\cf4 .\cf3 ProductID \cf4 AND\cf3   \par
    pv\cf4 .\cf3 BusinessEntityID \cf4 =\cf3  @vendor_id  \cf6 -- Variable value from the outer cursor  \cf3\par
  \par
    \cf1 OPEN\cf3  product_cursor  \par
    \cf1 FETCH\cf3  \cf1 NEXT\cf3  \cf1 FROM\cf3  product_cursor \cf1 INTO\cf3  @product  \par
  \par
    \cf1 IF\cf3  \cf7 @@FETCH_STATUS\cf3  \cf4 <>\cf3  0   \par
        \cf1 PRINT\cf3  \cf5 '         <<None>>'\cf3        \par
  \par
    \cf1 WHILE\cf3  \cf7 @@FETCH_STATUS\cf3  \cf4 =\cf3  0  \par
    \cf1 BEGIN\cf3   \par
  \par
        \cf1 SELECT\cf3  @message \cf4 =\cf3  \cf5 '         '\cf3  \cf4 +\cf3  @product  \par
        \cf1 PRINT\cf3  @message  \par
        \cf1 FETCH\cf3  \cf1 NEXT\cf3  \cf1 FROM\cf3  product_cursor \cf1 INTO\cf3  @product  \par
        \cf1 END\cf3   \par
  \par
    \cf1 CLOSE\cf3  product_cursor  \par
    \cf1 DEALLOCATE\cf3  product_cursor  \par
        \cf6 -- Get the next vendor.  \cf3\par
    \cf1 FETCH\cf3  \cf1 NEXT\cf3  \cf1 FROM\cf3  vendor_cursor \cf1 INTO\cf3  @vendor_id\cf4 ,\cf3  @vendor_name  \par
\cf1 END\cf3    \par
\cf1 CLOSE\cf3  vendor_cursor\cf4 ;\cf3   \par
\cf1 DEALLOCATE\cf3  vendor_cursor\cf4 ;\cf3   \par
\par
\par

\pard\sl240\slmult1\cf0\highlight0\f4\fs22\lang1049\'c8\'ed\'e4\'e5\'ea\'f1 \'e8\'ed\'f4\'eb\'ff\'f6\'e8\'e8 \f10\endash\f2\lang1033  \f4\lang1049\'ef\'ee\'ed\'ff\'f2\'e8\'e5 \'ea\'ee\'f2\'ee\'f0\'ee\'e5 \'ee\'f2\'ed\'ee\'f1\'e8\'f2\'f1\'ff \'ea \'cc\'e5\'f1\'ff\'f6\'f3 \'e8 \'c3\'ee\'e4\'f3\f2\lang1033  - \f4\lang1049\'f1\'ea\'f0\'e8\'ef\'f2 IndexInfl.sql\par
\par
\b\'c7\'c0\'c4\'c0\'cd\'c8\'c5 - \'c2\'fb\'f7\'e8\'f1\'eb\'e8\'f2\'fc \'e8\'ed\'e4\'e5\'ea\'f1 \'e8\'ed\'f4\'eb\'ff\'f6\'e8\'e8 \'ed\'e0\'f0\'e0\'f1\'f2\'e0\'fe\'f9\'e8\'ec \'e8\'f2\'ee\'e3\'ee\'ec \'e7\'e0 \'ef\'e5\'f0\'e8\'ee\'e4 \'f1 06.2006 \'ef\'ee 01.2012\par
\'cd\'e0\'ef\'e8\'f1\'e0\'f2\'fc \'f1\'ea\'e0\'eb\'ff\'f0\'ed\'f3\'fe \'f4\'f3\'ed\'ea\'f6\'e8\'fe, \'ea\'ee\'f2\'ee\'f0\'e0\'ff \'e2\'fb\'f7\'e8\'f1\'eb\'ff\'e5\'f2 \'e8\'ed\'e4\'e5\'ea\'f1 \'e8\'ed\'f4\'eb\'ff\'f6\'e8\'e8 \'ed\'e0\'f0\'e0\'f1\'f2\'e0\'fe\'f9\'e8\'ec \'e8\'f2\'ee\'e3\'ee\'ec \'e7\'e0 \'ef\'e5\'f0\'e8\'ee\'e4 \f2\lang1033 c DateStart \f4\lang1058\'e4\'ee \f2\lang1033 DateEnd.\f4\lang1049\par
\b0\lang1058\'d0\'e5\'e0\'eb\'e8\'e7\'ee\'e2\'e0\'f2\'fc \'e4\'e2\'e0 \'e2\'e0\'f0\'e8\'e0\'ed\'f2\'e0 - \'f1\lang1049  \'ef\'ee\'ec\'ee\'f9\'fc\'fe \'ea\'f3\'f0\'f1\'ee\'f0\'e0 \'e8 \'f1 \'ef\'ee\'ec\'ee\'f9\'fc\'fe \'e7\'e0\'ef\'f0\'ee\'f1\'e0!\par

\pard\li1440\sl240\slmult1\cf1\highlight2\f3\fs19 create\cf3  \cf1 function\cf3  GetIndex\cf4 (\cf3\par
 @DateStart \cf1 date\cf4 ,\cf3\par
 @DateEnd \cf1 date\cf3\par
\cf4 )\cf3\par
\cf1 returns\cf3  \cf1 numeric\cf4 (\cf3 18\cf4 ,\cf3 12\cf4 )\f6\lang1033 ...............\cf3\tab\cf0\highlight0\f4\fs22\lang1049\par

\pard\cf3\highlight2\f3\fs19\lang9\par
\par
\par
\cf0\b\f5\lang1049\par
}
 